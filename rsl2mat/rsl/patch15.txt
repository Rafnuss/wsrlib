--- rsl-v1.50/wsr88d_remove_sails_sweep.c	2016-11-18 14:49:23.000000000 -0500
+++ wsr88d_remove_sails_sweep.c	2021-07-23 11:01:24.380093030 -0400
@@ -1,11 +1,13 @@
 #include "rsl.h"
 
+#define MAX_SAILS 4
+
 void wsr88d_remove_sails_sweep(Radar *radar)
 {
     /* Remove SAILS sweeps.  For VCPs 12 and 212 only. */
 
     int i, j;
-    int sails_loc[4];
+    int sails_loc[MAX_SAILS];
     int isails, nsails;
 
     if (radar->h.vcp != 12 && radar->h.vcp != 212) return;
@@ -14,7 +16,7 @@
         if (radar->v[j]) {
             /* Find and save SAILS indices. */
             nsails = 0;
-            for (i=1; i < radar->v[j]->h.nsweeps; i++) {
+            for (i=1; i < radar->v[j]->h.nsweeps && nsails < MAX_SAILS; i++) {
                 /* If this sweep's elevation is less than previous sweep,
                    remove this sweep. */
                 if (radar->v[j]->sweep[i]->h.elev < 
